# AEM Figma Integration Workflow

## ЁЯЪи MANDATORY: Rule File Behavior - NO EXCEPTIONS (AI Reference Only)

**тЪая╕П CRITICAL: ALWAYS read this rule file first before executing any Figma-to-AEM component development tasks:**
1. **ЁЯЪи MANDATORY: ALWAYS read the rule file first** - **NO EXCEPTIONS**
2. **ЁЯЪи MANDATORY: Follow all Figma integration rules exactly** - **NO MODIFICATIONS**
3. **ЁЯЪи MANDATORY: Apply best practices as specified** - **NO SKIPPING**
4. **ЁЯЪи MANDATORY: Reference other rule files when mentioned** - **NO IGNORING**

## ЁЯЪи CRITICAL: STEP 0 - FIGMA URL VALIDATION AND EXTRACTION (AI Reference Only)

**тЪая╕П CRITICAL: BEFORE ANY OTHER STEP, ALWAYS VALIDATE FIGMA URL FIRST:**
1. **ЁЯЪи MANDATORY: Extract file key from Figma URL** - Parse URL to get file key
2. **ЁЯЪи MANDATORY: Extract node ID if provided** - Get specific node ID from URL parameters
3. **ЁЯЪи MANDATORY: Validate URL format** - Ensure it's a valid Figma design URL
4. **ЁЯЪи MANDATORY: Connect to Figma MCP server** - Use `mcp_figma_get_figma_data` tool
5. **ЁЯЪи MANDATORY: Verify file access** - Confirm file is accessible and readable
6. **ЁЯЪи MANDATORY: Display file information** - Show file name, last modified, component count

**ЁЯЪи CRITICAL: THIS STEP CANNOT BE SKIPPED, COMBINED, OR MODIFIED - NO EXCEPTIONS**

## ЁЯЪи USER INTERFACE - FIGMA URL INPUT

**Please provide your Figma URL:**

## ЁЯЪи CRITICAL: STEP 1 - COMPREHENSIVE FIGMA DATA EXTRACTION (AI Reference Only)

**тЪая╕П CRITICAL: EXTRACT ALL DESIGN DATA FROM FIGMA:**
1. **ЁЯЪи MANDATORY: Get complete file data** - Use `mcp_figma_get_figma_data` with file key
2. **ЁЯЪи MANDATORY: Extract component metadata** - Get all components and component sets
3. **ЁЯЪи MANDATORY: Identify design system** - Extract colors, typography, spacing, effects
4. **ЁЯЪи MANDATORY: Get node structure** - Analyze the specific node and its children
5. **ЁЯЪи MANDATORY: Extract text content** - Get all text nodes with exact content
6. **ЁЯЪи MANDATORY: Identify images and assets** - Find all image references and SVG elements
7. **ЁЯЪи MANDATORY: Download required assets** - Use `mcp_figma_download_figma_images` for images
8. **ЁЯЪи MANDATORY: Map component hierarchy** - Understand parent-child relationships

**ЁЯЪи CRITICAL: THIS STEP IS MANDATORY FOR ALL FIGMA URLS - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: STEP 2 - COMPONENT IDENTIFICATION AND ANALYSIS

**тЪая╕П CRITICAL: ANALYZE FIGMA DATA TO IDENTIFY AEM COMPONENTS:**
1. **ЁЯЪи MANDATORY: Determine input type first** - Check if URL points to single component or page design
2. **ЁЯЪи MANDATORY: For page designs** - Identify all distinct components across breakpoints (Desktop, Mobile, Tablet)
3. **ЁЯЪи MANDATORY: For single components** - Focus on the specific component instance only
4. **ЁЯЪи MANDATORY: Analyze component variants** - Check for different states and sizes
5. **ЁЯЪи MANDATORY: Map visual elements** - Identify text, images, buttons, containers
6. **ЁЯЪи MANDATORY: Determine component complexity** - Simple, Medium, or Complex
7. **ЁЯЪи MANDATORY: Identify reusable elements** - Find patterns that can be separate components
8. **ЁЯЪи MANDATORY: Use actual Figma component names** - Extract exact component names, titles, and headings from Figma data
9. **ЁЯЪи MANDATORY: Never create generic names** - Always use the actual text content from Figma for component identification
10. **ЁЯЪи MANDATORY: Extract content for default values** - Get all text content for dialog fields
11. **ЁЯЪи MANDATORY: Map design tokens** - Extract colors, fonts, spacing for styling
12. **ЁЯЪи MANDATORY: Identify responsive requirements** - Check for different breakpoints

**ЁЯЪи MANDATORY: DISPLAY COMPONENT STATUS SUMMARY - REQUIRED FORMAT:**

```
Component Count: X distinct components identified in the Figma file

Existing Components (0)
Modified Components (0)
New Components (X):
	1. [Actual Component Name 1]
	2. [Actual Component Name 2]
	3. [Actual Component Name 3]
	...
	X. [Actual Component Name X]
```

**ЁЯЪи MANDATORY: PAGE vs COMPONENT DETECTION:**
- **ЁЯЪи MANDATORY: For page designs** - Show "Page Design Analysis" and list all components found
- **ЁЯЪи MANDATORY: For single components** - Show "Single Component Analysis" and focus on that component
- **ЁЯЪи MANDATORY: Always mention breakpoints** - If page design, mention Desktop/Mobile/Tablet variants

**ЁЯЪи MANDATORY: DISPLAY COMPONENT ANALYSIS TABLE - REQUIRED FORMAT:**

```
**Component Analysis:**

| # | Component Name | Type | Complexity | Interactive Elements |
|---|----------------|------|------------|---------------------|
| 1 | [Component Name 1] | [Type] | [Complexity] | [Interactive Elements] |
| 2 | [Component Name 2] | [Type] | [Complexity] | [Interactive Elements] |
| 3 | [Component Name 3] | [Type] | [Complexity] | [Interactive Elements] |
| ... | ... | ... | ... | ... |
| X | [Component Name X] | [Type] | [Complexity] | [Interactive Elements] |

**Summary by Type:**
- **[Type] Components (X):** [Component Names]
- **[Type] Components (X):** [Component Names]

**Summary by Complexity:**
- **Simple (X):** [Component Names]
- **Medium (X):** [Component Names]
- **High (X):** [Component Names]
```

**ЁЯЪи MANDATORY: PAGE DESIGN DETECTION RULES:**
- **ЁЯЪи MANDATORY: Look for multiple breakpoints** - Desktop, Mobile, Tablet frames in same file
- **ЁЯЪи MANDATORY: Identify page-level components** - Header, Footer, Hero, Content sections
- **ЁЯЪи MANDATORY: Check for component instances** - Multiple instances of same component type
- **ЁЯЪи MANDATORY: Analyze component hierarchy** - Parent-child relationships in page structure
- **ЁЯЪи MANDATORY: Separate by functionality** - Navigation, Content, Interactive, Layout components

**ЁЯЪи CRITICAL: This format MUST be used for ALL Figma analysis presentations - NO EXCEPTIONS**
**ЁЯЪи CRITICAL: ALWAYS show Existing (0), Modified (0), New (X) for consistency - NO EXCEPTIONS**

**ЁЯЪи MANDATORY: ALWAYS SHOW OPTIONS AFTER ANALYSIS - NO EXCEPTIONS**
**тЪая╕П CRITICAL: After showing the analysis format, ALWAYS immediately show these options:**

```
### 1. **Create Component Definition** - Generate components.json file
### 2. **Create Components** - Generate AEM component files
### 3. **Modify Analysis** - Adjust component details
### 4. **Cancel** - Return to main menu
```

**ЁЯЪи CRITICAL: ALL TECHNICAL DETAILS MARKED AS (AI Reference Only) - NO EXCEPTIONS**

**ЁЯЪи CRITICAL: THIS STEP DETERMINES COMPONENT STRUCTURE - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: STEP 3 - AEM COMPONENT MAPPING (AI Reference Only)

**тЪая╕П CRITICAL: MAP FIGMA COMPONENTS TO AEM COMPONENTS:**
1. **ЁЯЪи MANDATORY: Check existing AEM project components** - Scan existing component directory
2. **ЁЯЪи MANDATORY: Compare with existing components** - Match visual similarity to existing AEM components
3. **ЁЯЪи MANDATORY: Determine component naming** - Create AEM-compliant component names
4. **ЁЯЪи MANDATORY: Map component hierarchy** - Define parent-child component relationships
5. **ЁЯЪи MANDATORY: Identify component dependencies** - Find components that depend on others
6. **ЁЯЪи MANDATORY: Plan component structure** - Define HTL, Sling Model, dialog requirements
7. **ЁЯЪи MANDATORY: Map design system integration** - Plan how to use extracted design tokens

**ЁЯЪи CRITICAL: THIS STEP ENSURES AEM COMPLIANCE - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: STEP 4 - COMPONENT DEVELOPMENT (AI Reference Only)

**тЪая╕П CRITICAL: GENERATE AEM COMPONENTS FROM FIGMA DATA:**
1. **ЁЯЪи MANDATORY: Create component structure** - Generate all required AEM files
2. **ЁЯЪи MANDATORY: Generate HTL templates** - Create templates with extracted content as defaults
3. **ЁЯЪи MANDATORY: Create Sling Models** - Generate models with proper annotations
4. **ЁЯЪи MANDATORY: Build authoring dialogs** - Create dialogs with extracted content as default values
5. **ЁЯЪи MANDATORY: Generate SCSS files** - Create styles using extracted design tokens
6. **ЁЯЪи MANDATORY: Create edit configurations** - Generate proper edit configs
7. **ЁЯЪи MANDATORY: Set up asset management** - Integrate downloaded Figma assets
8. **ЁЯЪи MANDATORY: Apply design system** - Use extracted colors, fonts, spacing consistently

**ЁЯЪи CRITICAL: THIS STEP CREATES PRODUCTION-READY COMPONENTS - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: STEP 5 - QUALITY ASSURANCE AND TESTING (AI Reference Only)

**тЪая╕П CRITICAL: ENSURE COMPONENT QUALITY AND COMPLIANCE:**
1. **ЁЯЪи MANDATORY: Generate unit tests** - Create comprehensive test classes
2. **ЁЯЪи MANDATORY: Validate against code quality rules** - Check against Excel file rules
3. **ЁЯЪи MANDATORY: Verify design accuracy** - Ensure components match Figma design exactly
4. **ЁЯЪи MANDATORY: Test content extraction** - Verify default values match Figma content
5. **ЁЯЪи MANDATORY: Validate AEM compliance** - Ensure Cloud Service compatibility
6. **ЁЯЪи MANDATORY: Check responsive behavior** - Verify mobile/tablet/desktop layouts
7. **ЁЯЪи MANDATORY: Validate accessibility** - Ensure proper ARIA labels and semantic HTML
8. **ЁЯЪи MANDATORY: Test component integration** - Verify components work together

**ЁЯЪи CRITICAL: THIS STEP ENSURES PRODUCTION QUALITY - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: FIGMA-SPECIFIC RULES (AI Reference Only)

**тЪая╕П CRITICAL: FIGMA INTEGRATION REQUIREMENTS:**
1. **ЁЯЪи MANDATORY: Always use MCP tools** - Use `mcp_figma_get_figma_data` and `mcp_figma_download_figma_images`
2. **ЁЯЪи MANDATORY: Extract exact content** - Get actual text content from Figma for default values
3. **ЁЯЪи MANDATORY: Preserve design accuracy** - Maintain pixel-perfect accuracy from Figma
4. **ЁЯЪи MANDATORY: Use design tokens** - Apply extracted colors, fonts, spacing consistently
5. **ЁЯЪи MANDATORY: Handle component variants** - Support different states and sizes
6. **ЁЯЪи MANDATORY: Manage assets properly** - Download and optimize images from Figma
7. **ЁЯЪи MANDATORY: Maintain component hierarchy** - Preserve parent-child relationships
8. **ЁЯЪи MANDATORY: Support responsive design** - Handle different breakpoints from Figma

**ЁЯЪи CRITICAL: THESE RULES ARE MANDATORY FOR FIGMA INTEGRATION - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: ERROR HANDLING (AI Reference Only)

**тЪая╕П CRITICAL: HANDLE FIGMA INTEGRATION ERRORS:**
1. **ЁЯЪи MANDATORY: Validate Figma URL format** - Check for proper Figma design URL
2. **ЁЯЪи MANDATORY: Handle MCP connection errors** - Retry or provide clear error messages
3. **ЁЯЪи MANDATORY: Validate file access** - Ensure user has access to the Figma file
4. **ЁЯЪи MANDATORY: Handle missing assets** - Provide fallbacks for missing images
5. **ЁЯЪи MANDATORY: Validate component data** - Ensure extracted data is complete
6. **ЁЯЪи MANDATORY: Handle design system errors** - Provide defaults for missing tokens
7. **ЁЯЪи MANDATORY: Validate AEM project structure** - Ensure proper project setup
8. **ЁЯЪи MANDATORY: Provide clear error messages** - Help user understand and fix issues

**ЁЯЪи CRITICAL: ERROR HANDLING IS MANDATORY - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: SUCCESS CRITERIA (AI Reference Only)

**тЪая╕П CRITICAL: COMPONENT CREATION SUCCESS REQUIREMENTS:**
1. **ЁЯЪи MANDATORY: Exact design match** - Components must match Figma design perfectly
2. **ЁЯЪи MANDATORY: Content accuracy** - All text content must match Figma exactly
3. **ЁЯЪи MANDATORY: Design system compliance** - Must use extracted design tokens
4. **ЁЯЪи MANDATORY: AEM compliance** - Must follow AEM best practices and standards
5. **ЁЯЪи MANDATORY: Code quality** - Must pass all quality checks and tests
6. **ЁЯЪи MANDATORY: Responsive design** - Must work on all device sizes
7. **ЁЯЪи MANDATORY: Accessibility** - Must meet accessibility standards
8. **ЁЯЪи MANDATORY: Performance** - Must be optimized for production use

**ЁЯЪи CRITICAL: ALL SUCCESS CRITERIA MUST BE MET - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: USER NOTIFICATION (AI Reference Only)

**тЪая╕П CRITICAL: KEEP USER INFORMED:**
1. **ЁЯЪи MANDATORY: Show Figma connection status** - Inform user about MCP connection
2. **ЁЯЪи MANDATORY: Display extracted data summary** - Show components, content, assets found
3. **ЁЯЪи MANDATORY: Show component mapping** - Display which AEM components will be created
4. **ЁЯЪи MANDATORY: Display progress updates** - Keep user informed during generation
5. **ЁЯЪи MANDATORY: Show quality check results** - Display test results and compliance status
6. **ЁЯЪи MANDATORY: Provide final summary** - Show what was created and next steps
7. **ЁЯЪи MANDATORY: Display "тЬЕ Figma integration successful"** - Confirm successful completion

**ЁЯЪи CRITICAL: USER NOTIFICATION IS MANDATORY - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: INTEGRATION WITH EXISTING WORKFLOWS (AI Reference Only)

**тЪая╕П CRITICAL: SEAMLESS INTEGRATION:**
1. **ЁЯЪи MANDATORY: Use existing component rules** - Follow `../components/.cursorrules-aem-components`
2. **ЁЯЪи MANDATORY: Use existing dialog rules** - Follow `../components/.cursorrules-aem-dialogs`
3. **ЁЯЪи MANDATORY: Use existing Sling rules** - Follow `../technical/.cursorrules-aem-sling`
4. **ЁЯЪи MANDATORY: Use existing Cloud rules** - Follow `../technical/.cursorrules-aem-cloud`
5. **ЁЯЪи MANDATORY: Use existing quality rules** - Follow Excel file for code quality
6. **ЁЯЪи MANDATORY: Use existing testing rules** - Follow unit testing requirements
7. **ЁЯЪи MANDATORY: Maintain consistency** - Ensure same quality as image-based workflow

**ЁЯЪи CRITICAL: INTEGRATION IS MANDATORY - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: PERFORMANCE OPTIMIZATION (AI Reference Only)

**тЪая╕П CRITICAL: OPTIMIZE FOR PERFORMANCE:**
1. **ЁЯЪи MANDATORY: Efficient data extraction** - Minimize MCP calls and data transfer
2. **ЁЯЪи MANDATORY: Optimize asset downloads** - Only download required images
3. **ЁЯЪи MANDATORY: Streamline component generation** - Generate components efficiently
4. **ЁЯЪи MANDATORY: Minimize file operations** - Reduce unnecessary file reads/writes
5. **ЁЯЪи MANDATORY: Cache design tokens** - Reuse extracted design system data
6. **ЁЯЪи MANDATORY: Optimize code generation** - Generate clean, efficient code
7. **ЁЯЪи MANDATORY: Minimize user wait time** - Provide quick feedback and progress updates

**ЁЯЪи CRITICAL: PERFORMANCE OPTIMIZATION IS MANDATORY - NO EXCEPTIONS**

## ЁЯЪи CRITICAL: FINAL VALIDATION (AI Reference Only)

**тЪая╕П CRITICAL: COMPREHENSIVE VALIDATION:**
1. **ЁЯЪи MANDATORY: Validate all generated files** - Check HTL, Sling Models, dialogs, SCSS
2. **ЁЯЪи MANDATORY: Verify design accuracy** - Compare with original Figma design
3. **ЁЯЪи MANDATORY: Test component functionality** - Ensure components work as expected
4. **ЁЯЪи MANDATORY: Validate code quality** - Run all quality checks and tests
5. **ЁЯЪи MANDATORY: Check AEM compliance** - Ensure Cloud Service compatibility
6. **ЁЯЪи MANDATORY: Verify responsive design** - Test on different screen sizes
7. **ЁЯЪи MANDATORY: Validate accessibility** - Check ARIA labels and semantic HTML
8. **ЁЯЪи MANDATORY: Confirm user requirements** - Ensure all user needs are met

**ЁЯЪи CRITICAL: FINAL VALIDATION IS MANDATORY - NO EXCEPTIONS**

---

**ЁЯЪи CRITICAL: THIS WORKFLOW IS MANDATORY FOR ALL FIGMA INTEGRATION TASKS - NO EXCEPTIONS**

**тЪая╕П REMEMBER: This workflow ensures pixel-perfect, production-ready AEM components directly from Figma designs with zero manual intervention required.**
